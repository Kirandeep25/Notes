{"ast":null,"code":"var _jsxFileName = \"/Users/ammarmahmood/Documents/GitHub/react-notebook/collabnote/client/src/components/notebook.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';\nimport { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { atomDark } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport { v4 as uuidv4 } from 'uuid';\nimport './notebook.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Notebook = ({\n  socket,\n  user,\n  viewMode\n}) => {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [notebook, setNotebook] = useState(null);\n  const [cells, setCells] = useState([]);\n  const [activeUsers, setActiveUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [editingTitle, setEditingTitle] = useState(false);\n  const [tempTitle, setTempTitle] = useState('');\n  const [cellOperations, setCellOperations] = useState({});\n  const titleInputRef = useRef(null);\n\n  // Auto-scroll to the cell being edited\n  const cellRefs = useRef({});\n  useEffect(() => {\n    if (socket) {\n      setLoading(true);\n      socket.emit('join-notebook', {\n        notebookId: id,\n        userId: user.id\n      });\n\n      // Listen for the notebook data\n      socket.on('notebook-data', data => {\n        setNotebook(data.notebook);\n        setCells(data.cells);\n        setTempTitle(data.notebook.title);\n        setLoading(false);\n      });\n\n      // Listen for individual cell updates\n      socket.on('cell-update', updatedCell => {\n        setCells(prevCells => prevCells.map(cell => cell.id === updatedCell.id ? updatedCell : cell));\n      });\n\n      // Listen for active users in this notebook\n      socket.on('active-users', users => {\n        setActiveUsers(users);\n      });\n\n      // Listen for errors\n      socket.on('error', err => {\n        setError(err.message);\n        setLoading(false);\n      });\n\n      // Cleanup listeners when unmounting\n      return () => {\n        socket.emit('leave-notebook', {\n          notebookId: id,\n          userId: user.id\n        });\n        socket.off('notebook-data');\n        socket.off('cell-update');\n        socket.off('active-users');\n        socket.off('error');\n      };\n    }\n  }, [socket, id, user.id]);\n\n  // Effect to scroll to cell or focus title input\n  useEffect(() => {\n    if (editingTitle && titleInputRef.current) {\n      titleInputRef.current.focus();\n    }\n  }, [editingTitle]);\n  const handleTitleClick = () => {\n    setEditingTitle(true);\n  };\n  const handleTitleChange = e => {\n    setTempTitle(e.target.value);\n  };\n  const handleTitleBlur = () => {\n    if (tempTitle.trim() !== notebook.title) {\n      socket.emit('update-notebook', {\n        notebookId: id,\n        title: tempTitle.trim() || 'Untitled Notebook',\n        userId: user.id\n      });\n    }\n    setEditingTitle(false);\n  };\n  const handleTitleKeyDown = e => {\n    if (e.key === 'Enter') {\n      handleTitleBlur();\n    }\n  };\n  const handleCellChange = (cellId, content) => {\n    // Update the cell locally immediately for a responsive feel\n    setCells(prevCells => prevCells.map(cell => cell.id === cellId ? {\n      ...cell,\n      content\n    } : cell));\n\n    // Debounce the socket update to avoid too many updates\n    if (cellOperations[cellId]) {\n      clearTimeout(cellOperations[cellId]);\n    }\n    const timeoutId = setTimeout(() => {\n      if (socket) {\n        socket.emit('update-cell', {\n          notebookId: id,\n          cellId,\n          content,\n          userId: user.id\n        });\n      }\n\n      // Clear this operation from tracking\n      setCellOperations(prev => {\n        const newOps = {\n          ...prev\n        };\n        delete newOps[cellId];\n        return newOps;\n      });\n    }, 500); // 500ms debounce\n\n    setCellOperations(prev => ({\n      ...prev,\n      [cellId]: timeoutId\n    }));\n  };\n  const addCell = (type, position) => {\n    const newCell = {\n      id: uuidv4(),\n      type,\n      content: type === 'markdown' ? '# New markdown cell' : '// New code cell',\n      createdBy: user.id,\n      createdAt: new Date().toISOString()\n    };\n    if (socket) {\n      socket.emit('add-cell', {\n        notebookId: id,\n        cell: newCell,\n        position\n      });\n    }\n  };\n  const deleteCell = cellId => {\n    if (socket) {\n      socket.emit('delete-cell', {\n        notebookId: id,\n        cellId\n      });\n    }\n  };\n  const moveCell = (cellId, direction) => {\n    const index = cells.findIndex(cell => cell.id === cellId);\n    if (direction === 'up' && index > 0 || direction === 'down' && index < cells.length - 1) {\n      const newCells = [...cells];\n      const targetIndex = direction === 'up' ? index - 1 : index + 1;\n      [newCells[index], newCells[targetIndex]] = [newCells[targetIndex], newCells[index]];\n\n      // Send all cells to update the order\n      if (socket) {\n        socket.emit('update-cells-order', {\n          notebookId: id,\n          cells: newCells,\n          userId: user.id\n        });\n      }\n\n      // Update local state immediately\n      setCells(newCells);\n    }\n  };\n  const executeCodeCell = (cellId, code) => {\n    if (socket) {\n      socket.emit('execute-code', {\n        notebookId: id,\n        cellId,\n        code,\n        userId: user.id\n      });\n\n      // Set a temporary \"Running...\" message\n      setCells(prevCells => prevCells.map(cell => cell.id === cellId ? {\n        ...cell,\n        output: 'Running...'\n      } : cell));\n    }\n  };\n  const handleKeyDown = (e, cellId, index) => {\n    // Shift+Enter to add a new cell below\n    if (e.key === 'Enter' && e.shiftKey) {\n      e.preventDefault();\n      const cell = cells.find(c => c.id === cellId);\n      addCell(cell.type, index + 1);\n    }\n\n    // Ctrl+Enter to execute code cell\n    if (e.key === 'Enter' && e.ctrlKey) {\n      e.preventDefault();\n      const cell = cells.find(c => c.id === cellId);\n      if (cell.type === 'code') {\n        executeCodeCell(cellId, cell.content);\n      }\n    }\n  };\n  const renderCellContent = cell => {\n    if (cell.type === 'markdown') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"markdown-cell\",\n        ref: el => cellRefs.current[cell.id] = el,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: cell.content,\n          onChange: e => handleCellChange(cell.id, e.target.value),\n          onKeyDown: e => handleKeyDown(e, cell.id, cells.indexOf(cell)),\n          placeholder: \"Write markdown here...\",\n          className: \"cell-editor\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"markdown-preview\",\n          children: /*#__PURE__*/_jsxDEV(ReactMarkdown, {\n            children: cell.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"code-cell\",\n        ref: el => cellRefs.current[cell.id] = el,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: cell.content,\n          onChange: e => handleCellChange(cell.id, e.target.value),\n          onKeyDown: e => handleKeyDown(e, cell.id, cells.indexOf(cell)),\n          placeholder: \"Write JavaScript code here...\",\n          className: \"cell-editor\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"code-preview\",\n          children: /*#__PURE__*/_jsxDEV(SyntaxHighlighter, {\n            language: \"javascript\",\n            style: atomDark,\n            children: cell.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => executeCodeCell(cell.id, cell.content),\n          className: \"run-code\",\n          children: \"Run\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this), cell.output && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"code-output\",\n          children: /*#__PURE__*/_jsxDEV(\"pre\", {\n            children: cell.output\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this);\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading notebook...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Error\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/'),\n        className: \"back-button\",\n        children: \"Back to Notebooks\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 7\n    }, this);\n  }\n  if (!notebook) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Notebook Not Found\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"The notebook you're looking for doesn't exist or you don't have access to it.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/'),\n        className: \"back-button\",\n        children: \"Back to Notebooks\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"notebook\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notebook-header\",\n      children: [editingTitle ? /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        ref: titleInputRef,\n        value: tempTitle,\n        onChange: handleTitleChange,\n        onBlur: handleTitleBlur,\n        onKeyDown: handleTitleKeyDown,\n        className: \"notebook-title-input\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"notebook-title\",\n        onClick: handleTitleClick,\n        children: notebook.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"active-users-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"active-users\",\n          children: activeUsers.map(activeUser => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"active-user\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"avatar\",\n              style: {\n                backgroundColor: activeUser.color\n              },\n              title: activeUser.name,\n              children: activeUser.name.charAt(0).toUpperCase()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"user-name\",\n              children: activeUser.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 17\n            }, this)]\n          }, activeUser.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `cells-container ${viewMode}`,\n      children: [cells.map((cell, index) => {\n        var _activeUsers$find;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cell\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cell-tools\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => addCell('markdown', index),\n              children: \"+ Markdown\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => addCell('code', index),\n              children: \"+ Code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => moveCell(cell.id, 'up'),\n              disabled: index === 0,\n              children: \"\\u2191\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => moveCell(cell.id, 'down'),\n              disabled: index === cells.length - 1,\n              children: \"\\u2193\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => deleteCell(cell.id),\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cell-info\",\n              children: cell.lastEditedBy && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"last-edited\",\n                children: [\"Last edited by \", ((_activeUsers$find = activeUsers.find(u => u.id === cell.lastEditedBy)) === null || _activeUsers$find === void 0 ? void 0 : _activeUsers$find.name) || 'Unknown']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 355,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 13\n          }, this), renderCellContent(cell)]\n        }, cell.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"add-cell-bottom\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => addCell('markdown', cells.length),\n          children: \"+ Markdown\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => addCell('code', cells.length),\n          children: \"+ Code\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notebook-footer\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shortcuts-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Shift+Enter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 17\n          }, this), \": Add new cell\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Ctrl+Enter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 17\n          }, this), \": Run code\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"notebook-stats\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [cells.length, \" cells\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"Created: \", new Date(notebook.createdAt).toLocaleDateString()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 305,\n    columnNumber: 5\n  }, this);\n};\n_s(Notebook, \"lhHHbuoxzIpas/sp64bvc7cB/Po=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = Notebook;\nexport default Notebook;\nvar _c;\n$RefreshReg$(_c, \"Notebook\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useNavigate","ReactMarkdown","Prism","SyntaxHighlighter","atomDark","v4","uuidv4","jsxDEV","_jsxDEV","Notebook","socket","user","viewMode","_s","id","navigate","notebook","setNotebook","cells","setCells","activeUsers","setActiveUsers","loading","setLoading","error","setError","editingTitle","setEditingTitle","tempTitle","setTempTitle","cellOperations","setCellOperations","titleInputRef","cellRefs","emit","notebookId","userId","on","data","title","updatedCell","prevCells","map","cell","users","err","message","off","current","focus","handleTitleClick","handleTitleChange","e","target","value","handleTitleBlur","trim","handleTitleKeyDown","key","handleCellChange","cellId","content","clearTimeout","timeoutId","setTimeout","prev","newOps","addCell","type","position","newCell","createdBy","createdAt","Date","toISOString","deleteCell","moveCell","direction","index","findIndex","length","newCells","targetIndex","executeCodeCell","code","output","handleKeyDown","shiftKey","preventDefault","find","c","ctrlKey","renderCellContent","className","ref","el","children","onChange","onKeyDown","indexOf","placeholder","fileName","_jsxFileName","lineNumber","columnNumber","language","style","onClick","onBlur","activeUser","backgroundColor","color","name","charAt","toUpperCase","_activeUsers$find","disabled","lastEditedBy","u","toLocaleDateString","_c","$RefreshReg$"],"sources":["/Users/ammarmahmood/Documents/GitHub/react-notebook/collabnote/client/src/components/notebook.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';\nimport { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { atomDark } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport { v4 as uuidv4 } from 'uuid';\nimport './notebook.css';\n\nconst Notebook = ({ socket, user, viewMode }) => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [notebook, setNotebook] = useState(null);\n  const [cells, setCells] = useState([]);\n  const [activeUsers, setActiveUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [editingTitle, setEditingTitle] = useState(false);\n  const [tempTitle, setTempTitle] = useState('');\n  const [cellOperations, setCellOperations] = useState({});\n  const titleInputRef = useRef(null);\n  \n  // Auto-scroll to the cell being edited\n  const cellRefs = useRef({});\n  \n  useEffect(() => {\n    if (socket) {\n      setLoading(true);\n      socket.emit('join-notebook', { notebookId: id, userId: user.id });\n      \n      // Listen for the notebook data\n      socket.on('notebook-data', (data) => {\n        setNotebook(data.notebook);\n        setCells(data.cells);\n        setTempTitle(data.notebook.title);\n        setLoading(false);\n      });\n      \n      // Listen for individual cell updates\n      socket.on('cell-update', (updatedCell) => {\n        setCells(prevCells => \n          prevCells.map(cell => \n            cell.id === updatedCell.id ? updatedCell : cell\n          )\n        );\n      });\n      \n      // Listen for active users in this notebook\n      socket.on('active-users', (users) => {\n        setActiveUsers(users);\n      });\n      \n      // Listen for errors\n      socket.on('error', (err) => {\n        setError(err.message);\n        setLoading(false);\n      });\n      \n      // Cleanup listeners when unmounting\n      return () => {\n        socket.emit('leave-notebook', { notebookId: id, userId: user.id });\n        socket.off('notebook-data');\n        socket.off('cell-update');\n        socket.off('active-users');\n        socket.off('error');\n      };\n    }\n  }, [socket, id, user.id]);\n  \n  // Effect to scroll to cell or focus title input\n  useEffect(() => {\n    if (editingTitle && titleInputRef.current) {\n      titleInputRef.current.focus();\n    }\n  }, [editingTitle]);\n  \n  const handleTitleClick = () => {\n    setEditingTitle(true);\n  };\n  \n  const handleTitleChange = (e) => {\n    setTempTitle(e.target.value);\n  };\n  \n  const handleTitleBlur = () => {\n    if (tempTitle.trim() !== notebook.title) {\n      socket.emit('update-notebook', {\n        notebookId: id,\n        title: tempTitle.trim() || 'Untitled Notebook',\n        userId: user.id\n      });\n    }\n    setEditingTitle(false);\n  };\n  \n  const handleTitleKeyDown = (e) => {\n    if (e.key === 'Enter') {\n      handleTitleBlur();\n    }\n  };\n  \n  const handleCellChange = (cellId, content) => {\n    // Update the cell locally immediately for a responsive feel\n    setCells(prevCells => \n      prevCells.map(cell => \n        cell.id === cellId ? { ...cell, content } : cell\n      )\n    );\n    \n    // Debounce the socket update to avoid too many updates\n    if (cellOperations[cellId]) {\n      clearTimeout(cellOperations[cellId]);\n    }\n    \n    const timeoutId = setTimeout(() => {\n      if (socket) {\n        socket.emit('update-cell', {\n          notebookId: id,\n          cellId,\n          content,\n          userId: user.id\n        });\n      }\n      \n      // Clear this operation from tracking\n      setCellOperations(prev => {\n        const newOps = { ...prev };\n        delete newOps[cellId];\n        return newOps;\n      });\n    }, 500); // 500ms debounce\n    \n    setCellOperations(prev => ({\n      ...prev,\n      [cellId]: timeoutId\n    }));\n  };\n  \n  const addCell = (type, position) => {\n    const newCell = {\n      id: uuidv4(),\n      type,\n      content: type === 'markdown' ? '# New markdown cell' : '// New code cell',\n      createdBy: user.id,\n      createdAt: new Date().toISOString()\n    };\n    \n    if (socket) {\n      socket.emit('add-cell', {\n        notebookId: id,\n        cell: newCell,\n        position\n      });\n    }\n  };\n  \n  const deleteCell = (cellId) => {\n    if (socket) {\n      socket.emit('delete-cell', {\n        notebookId: id,\n        cellId\n      });\n    }\n  };\n  \n  const moveCell = (cellId, direction) => {\n    const index = cells.findIndex(cell => cell.id === cellId);\n    if ((direction === 'up' && index > 0) || \n        (direction === 'down' && index < cells.length - 1)) {\n      \n      const newCells = [...cells];\n      const targetIndex = direction === 'up' ? index - 1 : index + 1;\n      [newCells[index], newCells[targetIndex]] = [newCells[targetIndex], newCells[index]];\n      \n      // Send all cells to update the order\n      if (socket) {\n        socket.emit('update-cells-order', {\n          notebookId: id,\n          cells: newCells,\n          userId: user.id\n        });\n      }\n      \n      // Update local state immediately\n      setCells(newCells);\n    }\n  };\n  \n  const executeCodeCell = (cellId, code) => {\n    if (socket) {\n      socket.emit('execute-code', {\n        notebookId: id,\n        cellId,\n        code,\n        userId: user.id\n      });\n      \n      // Set a temporary \"Running...\" message\n      setCells(prevCells => \n        prevCells.map(cell => \n          cell.id === cellId ? { ...cell, output: 'Running...' } : cell\n        )\n      );\n    }\n  };\n  \n  const handleKeyDown = (e, cellId, index) => {\n    // Shift+Enter to add a new cell below\n    if (e.key === 'Enter' && e.shiftKey) {\n      e.preventDefault();\n      const cell = cells.find(c => c.id === cellId);\n      addCell(cell.type, index + 1);\n    }\n    \n    // Ctrl+Enter to execute code cell\n    if (e.key === 'Enter' && e.ctrlKey) {\n      e.preventDefault();\n      const cell = cells.find(c => c.id === cellId);\n      if (cell.type === 'code') {\n        executeCodeCell(cellId, cell.content);\n      }\n    }\n  };\n  \n  const renderCellContent = (cell) => {\n    if (cell.type === 'markdown') {\n      return (\n        <div className=\"markdown-cell\" ref={el => cellRefs.current[cell.id] = el}>\n          <textarea\n            value={cell.content}\n            onChange={(e) => handleCellChange(cell.id, e.target.value)}\n            onKeyDown={(e) => handleKeyDown(e, cell.id, cells.indexOf(cell))}\n            placeholder=\"Write markdown here...\"\n            className=\"cell-editor\"\n          />\n          <div className=\"markdown-preview\">\n            <ReactMarkdown>{cell.content}</ReactMarkdown>\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"code-cell\" ref={el => cellRefs.current[cell.id] = el}>\n          <textarea\n            value={cell.content}\n            onChange={(e) => handleCellChange(cell.id, e.target.value)}\n            onKeyDown={(e) => handleKeyDown(e, cell.id, cells.indexOf(cell))}\n            placeholder=\"Write JavaScript code here...\"\n            className=\"cell-editor\"\n          />\n          <div className=\"code-preview\">\n            <SyntaxHighlighter language=\"javascript\" style={atomDark}>\n              {cell.content}\n            </SyntaxHighlighter>\n          </div>\n          <button \n            onClick={() => executeCodeCell(cell.id, cell.content)}\n            className=\"run-code\"\n          >\n            Run\n          </button>\n          {cell.output && (\n            <div className=\"code-output\">\n              <pre>{cell.output}</pre>\n            </div>\n          )}\n        </div>\n      );\n    }\n  };\n  \n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\"></div>\n        <p>Loading notebook...</p>\n      </div>\n    );\n  }\n  \n  if (error) {\n    return (\n      <div className=\"error-container\">\n        <h2>Error</h2>\n        <p>{error}</p>\n        <button onClick={() => navigate('/')} className=\"back-button\">\n          Back to Notebooks\n        </button>\n      </div>\n    );\n  }\n  \n  if (!notebook) {\n    return (\n      <div className=\"error-container\">\n        <h2>Notebook Not Found</h2>\n        <p>The notebook you're looking for doesn't exist or you don't have access to it.</p>\n        <button onClick={() => navigate('/')} className=\"back-button\">\n          Back to Notebooks\n        </button>\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"notebook\">\n      <div className=\"notebook-header\">\n        {editingTitle ? (\n          <input\n            type=\"text\"\n            ref={titleInputRef}\n            value={tempTitle}\n            onChange={handleTitleChange}\n            onBlur={handleTitleBlur}\n            onKeyDown={handleTitleKeyDown}\n            className=\"notebook-title-input\"\n          />\n        ) : (\n          <h1 className=\"notebook-title\" onClick={handleTitleClick}>\n            {notebook.title}\n          </h1>\n        )}\n        <div className=\"active-users-container\">\n          <div className=\"active-users\">\n            {activeUsers.map(activeUser => (\n              <div key={activeUser.id} className=\"active-user\">\n                <div \n                  className=\"avatar\" \n                  style={{ backgroundColor: activeUser.color }}\n                  title={activeUser.name}\n                >\n                  {activeUser.name.charAt(0).toUpperCase()}\n                </div>\n                <span className=\"user-name\">{activeUser.name}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n      \n      <div className={`cells-container ${viewMode}`}>\n        {cells.map((cell, index) => (\n          <div key={cell.id} className=\"cell\">\n            <div className=\"cell-tools\">\n              <button onClick={() => addCell('markdown', index)}>+ Markdown</button>\n              <button onClick={() => addCell('code', index)}>+ Code</button>\n              <button onClick={() => moveCell(cell.id, 'up')} disabled={index === 0}>\n                ↑\n              </button>\n              <button onClick={() => moveCell(cell.id, 'down')} disabled={index === cells.length - 1}>\n                ↓\n              </button>\n              <button onClick={() => deleteCell(cell.id)}>Delete</button>\n              <div className=\"cell-info\">\n                {cell.lastEditedBy && (\n                  <span className=\"last-edited\">\n                    Last edited by {activeUsers.find(u => u.id === cell.lastEditedBy)?.name || 'Unknown'}\n                  </span>\n                )}\n              </div>\n            </div>\n            \n            {renderCellContent(cell)}\n          </div>\n        ))}\n        \n        <div className=\"add-cell-bottom\">\n          <button onClick={() => addCell('markdown', cells.length)}>+ Markdown</button>\n          <button onClick={() => addCell('code', cells.length)}>+ Code</button>\n        </div>\n      </div>\n      \n      <div className=\"notebook-footer\">\n        <div className=\"shortcuts-info\">\n          <span><strong>Shift+Enter</strong>: Add new cell</span>\n          <span><strong>Ctrl+Enter</strong>: Run code</span>\n        </div>\n        <div className=\"notebook-stats\">\n          <span>{cells.length} cells</span>\n          <span>Created: {new Date(notebook.createdAt).toLocaleDateString()}</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Notebook;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}